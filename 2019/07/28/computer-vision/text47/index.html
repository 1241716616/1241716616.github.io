<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="一只行走的红烧肉" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="一只行走的红烧肉" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="一只行走的红烧肉" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="OpenCV 深度神经网络（DNN）模块"><link rel="canonical" href="http://example.com/2019/07/28/computer-vision/text47/"><title>OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割 - OpenCV图像处理算法 - 计算机视觉 | 业余天王 = 一只行走的红烧肉 = 流水账</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割</h1><div class="meta"><span class="item" title="创建时间：2019-07-28 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2019-07-28T00:00:00+08:00">2019-07-28</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>8.9k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>8 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">业余天王</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://pic.yupoo.com/1241716616/2ee109b1/0f0ae111.jpg"></li><li class="item" data-background-image="http://pic.yupoo.com/1241716616/04aaa6a5/a96748c5.jpg"></li><li class="item" data-background-image="http://pic.yupoo.com/1241716616/775a1b99/d102a643.jpg"></li><li class="item" data-background-image="http://pic.yupoo.com/1241716616/5c88f7e0/4c724949.jpg"></li><li class="item" data-background-image="http://pic.yupoo.com/1241716616/4349c425/60d3b8ff.jpg"></li><li class="item" data-background-image="http://pic.yupoo.com/1241716616/cbc67223/05b79fe6.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-vision/" itemprop="item" rel="index" title="分类于 计算机视觉"><span itemprop="name">计算机视觉</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-vision/Opencv/" itemprop="item" rel="index" title="分类于 OpenCV图像处理算法"><span itemprop="name">OpenCV图像处理算法</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2019/07/28/computer-vision/text47/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/author.jpg"><meta itemprop="name" content="Mr.Wang"><meta itemprop="description" content="流水账, 一只行走的红烧肉"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="一只行走的红烧肉"></span><div class="body md" itemprop="articleBody"><h1 id="opencv-深度神经网络dnn模块-fcn实现图像切割"><a class="anchor" href="#opencv-深度神经网络dnn模块-fcn实现图像切割">#</a> OpenCV 深度神经网络（DNN）模块 - FCN 实现图像切割</h1><h2 id="全卷积网络fcn"><a class="anchor" href="#全卷积网络fcn">#</a> 全卷积网络 (FCN)</h2><p>卷积神经网络从图像分类到到对象检测、实例分割、到图像语义分割、是卷积特征提取从粗糙输出到精炼输出的不断升级，基于卷积神经网络的全卷积分割网络 FCN 是像素级别的图像语义分割网络，相比以前传统的图像分割方法，基于卷积神经网络的分割更加的精准，适应性更强。</p><h3 id="fcn与普通cnn网络的区别"><a class="anchor" href="#fcn与普通cnn网络的区别">#</a> FCN 与普通 CNN 网络的区别：</h3><p>通常 CNN 网络在卷积层之后会接上若干个全连接层，将卷积层产生的特征图 (feature map) 映射成一个固定长度的特征向量。以 AlexNet 为代表的经典 CNN 结构适合于图像级的分类和回归任务，因为它们最后都期望得到整个输入图像的一个数值描述（概率），比如 AlexNet 的 ImageNet 模型输出一个 1000 维的向量表示输入图像属于每一类的概率 (softmax 归一化)。</p><p>全卷积网络 (FCN) 是从抽象的特征中恢复出每个像素所属的类别。即从图像级别的分类进一步延伸到像素级别的分类。</p><p>FCN 将传统 CNN 中的全连接层转化成一个个的卷积层。如下图所示，在传统的 CNN 结构中，前 5 层是卷积层，第 6 层和第 7 层分别是一个长度为 4096 的一维向量，第 8 层是长度为 1000 的一维向量，分别对应 1000 个类别的概率。FCN 将这 3 层表示为卷积层，卷积核的大小 (通道数，宽，高) 分别为（4096,1,1）、（4096,1,1）、（1000,1,1）。所有的层都是卷积层，故称为全卷积网络。</p><ul><li>举例：下图中的猫，输入 AlexNet, 得到一个长为 1000 的输出向量，表示输入图像属于每一类的概率，其中在 “tabby cat” 这一类统计概率最高（如下图）。</li></ul><p><img data-src="/images/textimages/text47/1.png" alt="1.png | center | 300x0"></p><p>FCN 对图像进行像素级的分类，从而解决了语义级别的图像分割（semantic segmentation）问题。与经典的 CNN 在卷积层之后使用全连接层得到固定长度的特征向量进行分类（全联接层＋softmax 输出）不同，FCN 可以接受任意尺寸的输入图像，采用反卷积层对最后一个卷积层的 feature map 进行上采样，使它恢复到输入图像相同的尺寸，从而可以对每个像素都产生了一个预测，同时保留了原始输入图像中的空间信息，最后在上采样的特征图上进行逐像素分类（如上图）。</p><p>简单的说，FCN 与 CNN 的区别在于 FCN 把 CNN 最后的全连接层换成卷积层，输出一张已经 label 好的图。</p><p>其实，CNN 的强大之处在于它的多层结构能自动学习特征，并且可以学习到多个层次的特征：较浅的卷积层感知域较小，学习到一些局部区域的特征；较深的卷积层具有较大的感知域，能够学习到更加抽象一些的特征。这些抽象特征对物体的大小、位置和方向等敏感性更低，从而有助于识别性能的提高。下图 CNN 分类网络的示意图：</p><p><img data-src="/images/textimages/text47/2.png" alt="2.png | center | 300x0"></p><p>这些抽象的特征对分类很有帮助，可以很好地判断出一幅图像中包含什么类别的物体，但是因为丢失了一些物体的细节，不能很好地给出物体的具体轮廓、指出每个像素具体属于哪个物体，因此做到精确的分割就很有难度。</p><p>传统的基于 CNN 的分割方法：为了对一个像素分类，使用该像素周围的一个图像块作为 CNN 的输入用于训练和预测。这种方法有几个缺点：一是存储开销很大。例如对每个像素使用的图像块的大小为 15x15，然后不断滑动窗口，每次滑动的窗口给 CNN 进行判别分类，因此则所需的存储空间根据滑动窗口的次数和大小急剧上升。二是计算效率低下。相邻的像素块基本上是重复的，针对每个像素块逐个计算卷积，这种计算也有很大程度上的重复。三是像素块大小的限制了感知区域的大小。通常像素块的大小比整幅图像的大小小很多，只能提取一些局部的特征，从而导致分类的性能受到限制。</p><p>而全卷积网络 (FCN) 则是从抽象的特征中恢复出每个像素所属的类别。即从图像级别的分类进一步延伸到像素级别的分类。</p><h3 id="网络结构"><a class="anchor" href="#网络结构">#</a> 网络结构</h3><p>输入可为任意尺寸图像彩色图像；输出与输入尺寸相同，深度为：20 类目标 + 背景 = 21。 （在 PASCAL 数据集上进行的，PASCAL 一共 20 类）</p><p><strong>全连接层 转换成卷积层</strong></p><p>全连接层和卷积层之间唯一的不同就是卷积层中的神经元只与输入数据中的一个局部区域连接，并且在卷积列中的神经元共享参数。然而在两类层中，神经元都是计算点积，所以它们的函数形式是一样的。因此，将此两者相互转化是可能的：</p><p>（1）对于任一个卷积层，都存在一个能实现和它一样的前向传播函数的全连接层。权重矩阵是一个巨大的矩阵，除了某些特定块，其余部分都是零。而在其中大部分块中，元素都是相等的。<br>（2）相反，任何全连接层都可以被转化为卷积层。比如，一个 K=4096 的全连接层，输入数据体的尺寸是 7x7x512，这个全连接层可以被等效地看做一个 F=7,P=0,S=1,K=4096 的卷积层。换句话说，就是将滤波器的尺寸设置为和输入数据体的尺寸一致了。因为只有一个单独的深度列覆盖并滑过输入数据体，所以输出将变成 1x1x4096，这个结果就和使用初始的那个全连接层一样了。</p><p>全连接层转化为卷积层：在两种变换中，将全连接层转化为卷积层在实际运用中更加有用。假设一个卷积神经网络的输入是 224x224x3 的图像，一系列的卷积层和下采样层将图像数据变为尺寸为 7x7x512 的激活数据体。AlexNet 使用了两个尺寸为 4096 的全连接层，最后一个有 1000 个神经元的全连接层用于计算分类评分。我们可以将这 3 个全连接层中的任意一个转化为卷积层：<br>（1）针对第一个连接区域是 [7x7x512] 的全连接层，令其滤波器尺寸为 F=7，这样输出数据体就为 [1x1x4096] 了。<br>（2）针对第二个全连接层，令其滤波器尺寸为 F=1，这样输出数据体为 [1x1x4096]。<br>（3）对最后一个全连接层也做类似的，令其 F=1，最终输出为 [1x1x1000]</p><p>实际操作中，每次这样的变换都需要把全连接层的权重 W 重塑成卷积层的滤波器。那么这样的转化有什么作用呢？它在下面的情况下可以更高效：让卷积网络在一张更大的输入图片上滑动，得到多个输出，这样的转化可以让我们在单个向前传播的过程中完成上述的操作。</p><p>举个栗子：如果我们想让 224×224 尺寸的浮窗，以步长为 32 在 384×384 的图片上滑动，把每个经停的位置都带入卷积网络，最后得到 6×6 个位置的类别得分。上述的把全连接层转换成卷积层的做法会更简便。如果 224×224 的输入图片经过卷积层和下采样层之后得到了 [7x7x512] 的数组，那么，384×384 的大图片直接经过同样的卷积层和下采样层之后会得到 [12x12x512] 的数组。然后再经过上面由 3 个全连接层转化得到的 3 个卷积层，最终得到 [6x6x1000] 的输出 ((12 – 7) / 1 + 1 = 6)。这个结果正是浮窗在原图经停的 6×6 个位置的得分！</p><p>面对 384×384 的图像，让（含全连接层）的初始卷积神经网络以 32 像素的步长独立对图像中的 224×224 块进行多次评价，其效果和使用把全连接层变换为卷积层后的卷积神经网络进行一次前向传播是一样的。</p><p>如下图所示，FCN 将传统 CNN 中的全连接层转化成卷积层，对应 CNN 网络 FCN 把最后三层全连接层转换成为三层卷积层。在传统的 CNN 结构中，前 5 层是卷积层，第 6 层和第 7 层分别是一个长度为 4096 的一维向量，第 8 层是长度为 1000 的一维向量，分别对应 1000 个不同类别的概率。FCN 将这 3 层表示为卷积层，卷积核的大小 (通道数，宽，高) 分别为 (4096,1,1)、(4096,1,1)、(1000,1,1)。看上去数字上并没有什么差别，但是卷积跟全连接是不一样的概念和计算过程，使用的是之前 CNN 已经训练好的权值和偏置，但是不一样的在于权值和偏置是有自己的范围，属于自己的一个卷积核。因此 FCN 网络中所有的层都是卷积层，故称为全卷积网络。</p><p><img data-src="/images/textimages/text47/4.png" alt="4.png | center | 300x0"></p><p>下图是一个全卷积层，与上图不一样的是图像对应的大小下标，CNN 中输入的图像大小是同意固定 resize 成 227x227 大小的图像，第一层 pooling 后为 55x55，第二层 pooling 后图像大小为 27x27，第五层 pooling 后的图像大小为 13 x 13。而 FCN 输入的图像是 H*W 大小，第一层 pooling 后变为原图大小的 1/4，第二层变为原图大小的 1/8，第五层变为原图大小的 1/16，第八层变为原图大小的 1/32（勘误：其实真正代码当中第一层是 1/2，以此类推）。</p><p><img data-src="/images/textimages/text47/5.png" alt="5.png | center | 300x0"></p><p>经过多次卷积和 pooling 以后，得到的图像越来越小，分辨率越来越低。其中图像到 H/32 x W/32 的时候图片是最小的一层时，所产生图叫做 heatmap 热图，热图就是我们最重要的高维特诊图，得到高维特征的 heatmap 之后就是最重要的一步也是最后的一步对原图像进行 upsampling，把图像进行放大、放大、放大，到原图像的大小。</p><p><img data-src="/images/textimages/text47/6.png" alt="6.png | center | 300x0"></p><p>最后的输出是 1000 张 heatmap 经过 upsampling 变为原图大小的图片，为了对每个像素进行分类预测 label 成最后已经进行语义分割的图像，这里有一个小 trick，就是最后通过逐个像素地求其在 1000 张图像该像素位置的最大数值描述（概率）作为该像素的分类。因此产生了一张已经分类好的图片，如下图右侧有狗狗和猫猫的图。</p><p><strong>upsampling：</strong></p><p>相较于使用被转化前的原始卷积神经网络对所有 36 个位置进行迭代计算，使用转化后的卷积神经网络进行一次前向传播计算要高效得多，因为 36 次计算都在共享计算资源。这一技巧在实践中经常使用，一次来获得更好的结果。比如，通常将一张图像尺寸变得更大，然后使用变换后的卷积神经网络来对空间上很多不同位置进行评价得到分类评分，然后在求这些分值的平均值。</p><p>最后，如果我们想用步长小于 32 的浮窗怎么办？用多次的向前传播就可以解决。比如我们想用步长为 16 的浮窗。那么先使用原图在转化后的卷积网络执行向前传播，然后分别沿宽度，沿高度，最后同时沿宽度和高度，把原始图片分别平移 16 个像素，然后把这些平移之后的图分别带入卷积网络。</p><p><img data-src="/images/textimages/text47/8.png" alt="8.png | center | 300x0"></p><p>如下图所示，当图片在网络中经过处理后变成越小的图片，其特征也越明显，就像图像中颜色所示，当然啦，最后一层的图片不再是一个 1 个像素的图片，而是原图像 H/32xW/32 大小的图，这里为了简化而画成一个像素而已。</p><p><img data-src="/images/textimages/text47/9.png" alt="9.png | center | 300x0"></p><p>如下图所示，对原图像进行卷积 conv1、pool1 后原图像缩小为 1/2；之后对图像进行第二次 conv2、pool2 后图像缩小为 1/4；接着继续对图像进行第三次卷积操作 conv3、pool3 缩小为原图像的 1/8，此时保留 pool3 的 featureMap；接着继续对图像进行第四次卷积操作 conv4、pool4，缩小为原图像的 1/16，保留 pool4 的 featureMap；最后对图像进行第五次卷积操作 conv5、pool5，缩小为原图像的 1/32，然后把原来 CNN 操作中的全连接变成卷积操作 conv6、conv7，图像的 featureMap 数量改变但是图像大小依然为原图的 1/32，此时图像不再叫 featureMap 而是叫 heatMap。</p><p>现在我们有 1/32 尺寸的 heatMap，1/16 尺寸的 featureMap 和 1/8 尺寸的 featureMap，1/32 尺寸的 heatMap 进行 upsampling 操作之后，因为这样的操作还原的图片仅仅是 conv5 中的卷积核中的特征，限于精度问题不能够很好地还原图像当中的特征，因此在这里向前迭代。把 conv4 中的卷积核对上一次 upsampling 之后的图进行反卷积补充细节（相当于一个差值过程），最后把 conv3 中的卷积核对刚才 upsampling 之后的图像进行再次反卷积补充细节，最后就完成了整个图像的还原。</p><p><img data-src="/images/textimages/text47/10.png" alt="10.png | center | 300x0"></p><p><strong>FCN 的缺点</strong></p><p>（1）得到的结果还是不够精细。进行 8 倍上采样虽然比 32 倍的效果好了很多，但是上采样的结果还是比较模糊和平滑，对图像中的细节不敏感。</p><p>（2）是对各个像素进行分类，没有充分考虑像素与像素之间的关系。忽略了在通常的基于像素分类的分割方法中使用的空间规整（spatial regularization）步骤，缺乏空间一致性。</p><h3 id="案例实战"><a class="anchor" href="#案例实战">#</a> 案例实战</h3><p>使用 FCN 实现图像分割，需要三个文件，pascal-classes.txt 和 fcn8s-heavy-pascal.prototxt 可以在安装 OpenCV 路径下找到，fcn8s-heavy-pascal.caffemodel 模型可以在网上自行下载，也可以在后台回复 model 获得例子所用文件。</p><p><strong>读取 label 值：</strong><br>对于图像分割和常规的检测是不一样的，他是对输入图像全局的每一个像素进行的识别，也就是说每一个像素点都应该有一个对应的 label 和 value 值，如果你能明白这个思想下面就好办了，我们读取 label 值内容如下：</p><p><img data-src="/images/textimages/text47/12.png" alt="12.png | center | 300x0"></p><p>我们可以看到每个值都是三通道的，如果是之前的检测结果，应该用 vector&lt;String&gt; 存储，换成通道 value，我们用 vector&lt;Vec3b &gt; 来存储。</p><p><strong>例子代码：</strong></p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2/dnn.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv::dnn;</span><br><span class="line"></span><br><span class="line">String fcn_label_txt = <span class="string">&quot;G:/SouresCode/vsCodeCV/testDnn/dnn/fcn/pascal-classes.txt&quot;</span>;</span><br><span class="line">String fcn_txt = <span class="string">&quot;G:/SouresCode/vsCodeCV/testDnn/dnn/fcn/fcn8s-heavy-pascal.prototxt&quot;</span>;</span><br><span class="line">String fcn_model = <span class="string">&quot;G:/SouresCode/vsCodeCV/testDnn/dnn/fcn/fcn8s-heavy-pascal.caffemodel&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;Vec3b&gt; <span class="title">readColors</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;Vec3b&gt; colors;</span><br><span class="line">	<span class="function">ifstream <span class="title">fp</span><span class="params">(fcn_label_txt)</span></span>;  <span class="comment">//创建流</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!fp.is_open())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;can not open label file...\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">string</span> line;</span><br><span class="line">	<span class="keyword">while</span> (!fp.eof()) <span class="comment">//如果流没有结束</span></span><br><span class="line">	&#123;</span><br><span class="line">		getline(fp, line);</span><br><span class="line">		<span class="keyword">if</span> (line.length()) <span class="comment">//判断是否可以打开</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function"><span class="built_in">stringstream</span> <span class="title">ss</span><span class="params">(line)</span></span>;  <span class="comment">//创建字符流</span></span><br><span class="line">			<span class="built_in">string</span> name;</span><br><span class="line">			ss &gt;&gt; name;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> temp;</span><br><span class="line">			Vec3b color;</span><br><span class="line">			ss &gt;&gt; temp;</span><br><span class="line">			<span class="comment">//cout &lt;&lt; temp &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">			color[<span class="number">0</span>] = (uchar)temp;</span><br><span class="line">			ss &gt;&gt; temp;</span><br><span class="line">			color[<span class="number">1</span>] = (uchar)temp;</span><br><span class="line">			ss &gt;&gt; temp;</span><br><span class="line">			color[<span class="number">2</span>] = (uchar)temp;</span><br><span class="line">			<span class="comment">//cout &lt;&lt; temp &lt;&lt; endl;</span></span><br><span class="line">			colors.push_back(color);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> colors;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//图像处理与初始化模型</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Mat srcImg = imread(<span class="string">&quot;000067.jpg&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (srcImg.empty())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;input image is empty...\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	resize(srcImg, srcImg, Size(<span class="number">500</span>, <span class="number">500</span>));</span><br><span class="line">	<span class="comment">//namedWindow(&quot;input&quot;, CV_WINDOW_AUTOSIZE);</span></span><br><span class="line">	imshow(<span class="string">&quot;input&quot;</span>, srcImg);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;Vec3b&gt; labels = readColors();</span><br><span class="line">	Mat blobImg = blobFromImage(srcImg);</span><br><span class="line"></span><br><span class="line">	Net net = readNetFromCaffe(fcn_txt, fcn_model);</span><br><span class="line">	<span class="keyword">if</span> (net.empty())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;init net error...\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">float</span> time = getTickCount();  <span class="comment">//计时器</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; time &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">	net.setInput(blobImg, <span class="string">&quot;data&quot;</span>);</span><br><span class="line">	Mat score = net.forward(<span class="string">&quot;score&quot;</span>);</span><br><span class="line">	<span class="keyword">float</span> tt = getTickCount() - time;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;time consume: &quot;</span> &lt;&lt; (tt / getTickFrequency() * <span class="number">1000</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	定义查找表，why? 从结果角度来说，我们要知道输入图像，</span></span><br><span class="line"><span class="comment">	每一个像素属于哪个通道（21个label的坐标）以及对应的value值</span></span><br><span class="line"><span class="comment">	是多少，所以要声明一个对应的查找表，后续来做map</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//cout &lt;&lt; score.size &lt;&lt; &quot; &quot; &lt;&lt; score.size[1] &lt;&lt; &quot; &quot;</span></span><br><span class="line">	<span class="comment">//	 &lt;&lt; score.size[2]	&lt;&lt; &quot; &quot; &lt;&lt; score.size[3] &lt;&lt; endl;</span></span><br><span class="line">	<span class="comment">//21*500*500</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> rows = score.size[<span class="number">2</span>];  <span class="comment">//height</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> cols = score.size[<span class="number">3</span>];  <span class="comment">//width</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> chls = score.size[<span class="number">1</span>];  <span class="comment">//channels</span></span><br><span class="line"></span><br><span class="line">	<span class="function">Mat <span class="title">maxC1</span><span class="params">(rows, cols, CV_8UC1)</span></span>;  <span class="comment">//存储最终选定的通道 （21分之1）</span></span><br><span class="line">	<span class="function">Mat <span class="title">MaxVal</span><span class="params">(rows,cols, CV_32FC1)</span></span>;  <span class="comment">//存储label的key</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//查找表的生成</span></span><br><span class="line">	<span class="comment">//我们要遍历的score 是数据结构为21个通道，每个通道是500*500像素的结果</span></span><br><span class="line">	<span class="comment">//set 查找表</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; chls; c++) <span class="comment">//一共21个通道代表21个通道在每个下像素点的置信度</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; rows; row++)  <span class="comment">//500行</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//指向每个通道的第1个位置，存储的是21个label的置信度</span></span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">float</span> *ptrScore = score.ptr&lt;<span class="keyword">float</span>&gt;(<span class="number">0</span>, c, row); </span><br><span class="line">			<span class="comment">//cout &lt;&lt; *ptrScore &lt;&lt; endl;</span></span><br><span class="line">			uchar *ptrMaxC1 = maxC1.ptr&lt;uchar&gt;(row);</span><br><span class="line">			<span class="keyword">float</span> *ptrMaxVal = MaxVal.ptr&lt;<span class="keyword">float</span>&gt;(row);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> col=<span class="number">0</span>; col &lt; cols; col++)  <span class="comment">//500列</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (ptrScore[col]&gt;ptrMaxVal[col])  <span class="comment">//21个通道的同一个位置取最大值</span></span><br><span class="line">				&#123;</span><br><span class="line">					ptrMaxVal[col] = ptrScore[col];  <span class="comment">//存储最终的值也就是color帐的结果</span></span><br><span class="line">					ptrMaxC1[col] = (uchar)c;  <span class="comment">//存储最终选择的通道</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出结果</span></span><br><span class="line">	<span class="comment">//声明一个500*500的zero Mat 对象，依次map中查找表中的位置，输出结果</span></span><br><span class="line">	Mat result = Mat::zeros(rows, cols, CV_8UC3);  <span class="comment">//初始化全0的图像矩阵</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; rows; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">const</span> uchar *ptrMaxC1 = maxC1.ptr&lt;uchar&gt;(row);  <span class="comment">//指向对应的查找表中的行</span></span><br><span class="line">		Vec3b *ptrColor = result.ptr&lt;Vec3b&gt;(row);  <span class="comment">//指向查找表中的行</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; cols; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			ptrColor[col] = labels[ptrMaxC1[col]];  <span class="comment">//对应位置</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//合并图像操作</span></span><br><span class="line">	<span class="comment">//Mat dstImg;</span></span><br><span class="line">	<span class="comment">//addWeighted(srcImg, 0.3, result, 0.7, 0, dstImg);</span></span><br><span class="line">	imshow(<span class="string">&quot;result&quot;</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	test();</span><br><span class="line">	waitKey();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>效果：</strong></p><p><img data-src="/images/textimages/text47/11.png" alt="11.png | center | 300x0"></p><ul><li>总结：图像分割运行的速度慢一些，在 GPU 会快些，最新出的 Mask Rcnn 不知道怎么样，有时间可以去试一试。</li></ul><div class="tags"><a href="/tags/OpenCV-%E6%B7%B1%E5%BA%A6%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%88DNN%EF%BC%89%E6%A8%A1%E5%9D%97/" rel="tag"><i class="ic i-tag"></i> OpenCV 深度神经网络（DNN）模块</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2020-12-17 21:00:16" itemprop="dateModified" datetime="2020-12-17T21:00:16+08:00">2020-12-17</time> </span><span id="2019/07/28/computer-vision/text47/" class="item leancloud_visitors" data-flag-title="OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Mr.Wang <i class="ic i-at"><em>@</em></i>一只行走的红烧肉</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2019/07/28/computer-vision/text47/" title="OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割">http://example.com/2019/07/28/computer-vision/text47/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2019/07/27/computer-vision/text46/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;pic.yupoo.com&#x2F;1241716616&#x2F;46783596&#x2F;9da203e2.jpg" title="OpenCV 深度神经网络（DNN）模块 -Mobilenet_SSD深度学习模型的调用与目标识别"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> OpenCV图像处理算法</span><h3>OpenCV 深度神经网络（DNN）模块 -Mobilenet_SSD深度学习模型的调用与目标识别</h3></a></div><div class="item right"><a href="/2019/07/29/computer-vision/text48/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;pic.yupoo.com&#x2F;1241716616&#x2F;60b041af&#x2F;81910e1d.jpg" title="OpenCV 深度神经网络（DNN）模块 - 基于CNN的年龄性别检测"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> OpenCV图像处理算法</span><h3>OpenCV 深度神经网络（DNN）模块 - 基于CNN的年龄性别检测</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#opencv-%E6%B7%B1%E5%BA%A6%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9Cdnn%E6%A8%A1%E5%9D%97-fcn%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%83%8F%E5%88%87%E5%89%B2"><span class="toc-number">1.</span> <span class="toc-text">OpenCV 深度神经网络（DNN）模块 - FCN 实现图像切割</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9Cfcn"><span class="toc-number">1.1.</span> <span class="toc-text">全卷积网络 (FCN)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fcn%E4%B8%8E%E6%99%AE%E9%80%9Acnn%E7%BD%91%E7%BB%9C%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.1.</span> <span class="toc-text">FCN 与普通 CNN 网络的区别：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">网络结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98"><span class="toc-number">1.1.3.</span> <span class="toc-text">案例实战</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2019/05/12/computer-vision/text14/" rel="bookmark" title="定义感兴趣区">定义感兴趣区</a></li><li><a href="/2019/05/13/computer-vision/text15/" rel="bookmark" title="操作像素">操作像素</a></li><li><a href="/2019/05/14/computer-vision/text16/" rel="bookmark" title="处理图像的颜色">处理图像的颜色</a></li><li><a href="/2019/05/15/computer-vision/text17/" rel="bookmark" title="形态学操作">形态学操作</a></li><li><a href="/2019/05/17/computer-vision/text18/" rel="bookmark" title="图像滤波">图像滤波</a></li><li><a href="/2019/05/19/computer-vision/text19/" rel="bookmark" title="直方图">直方图</a></li><li><a href="/2019/05/21/computer-vision/text20/" rel="bookmark" title="模板匹配">模板匹配</a></li><li><a href="/2019/05/24/computer-vision/text21/" rel="bookmark" title="提取直线、轮廓">提取直线、轮廓</a></li><li><a href="/2019/05/26/computer-vision/text22/" rel="bookmark" title="提取区域">提取区域</a></li><li><a href="/2019/05/29/computer-vision/text23/" rel="bookmark" title="角点检测">角点检测</a></li><li><a href="/2019/06/02/computer-vision/text24/" rel="bookmark" title="SURF、SIFT 特征检测">SURF、SIFT 特征检测</a></li><li><a href="/2019/06/03/computer-vision/text25/" rel="bookmark" title="HOG、LBP 和 Harr 三大特征">HOG、LBP 和 Harr 三大特征</a></li><li><a href="/2019/06/06/computer-vision/text26/" rel="bookmark" title="描述和匹配兴趣点">描述和匹配兴趣点</a></li><li><a href="/2019/06/08/computer-vision/text27/" rel="bookmark" title="积分图像">积分图像</a></li><li><a href="/2019/06/10/computer-vision/text28/" rel="bookmark" title="案例实战">案例实战</a></li><li><a href="/2019/06/12/computer-vision/text29/" rel="bookmark" title="Opencv+VS环境配置一次，使用永久">Opencv+VS环境配置一次，使用永久</a></li><li><a href="/2019/06/15/computer-vision/text30/" rel="bookmark" title="案例实战II">案例实战II</a></li><li><a href="/2019/06/17/computer-vision/text31/" rel="bookmark" title="常用综合案例练习">常用综合案例练习</a></li><li><a href="/2019/06/20/computer-vision/text32/" rel="bookmark" title="图像轮廓">图像轮廓</a></li><li><a href="/2019/06/22/computer-vision/text33/" rel="bookmark" title="图像分割实战-K均值算法（K-Means） 和高斯混合算法（GMM）">图像分割实战-K均值算法（K-Means） 和高斯混合算法（GMM）</a></li><li><a href="/2019/06/25/computer-vision/text34/" rel="bookmark" title="图像分割实战-分水岭分割方法和GrabCut 算法分割图像">图像分割实战-分水岭分割方法和GrabCut 算法分割图像</a></li><li><a href="/2019/06/26/computer-vision/text35/" rel="bookmark" title="图像分割实战-证件照背景替换">图像分割实战-证件照背景替换</a></li><li><a href="/2019/06/28/computer-vision/text36/" rel="bookmark" title="图像分割实战-视频背景替换">图像分割实战-视频背景替换</a></li><li><a href="/2019/07/02/computer-vision/text37/" rel="bookmark" title="视频分析与对象跟踪-背景消去建模和基于颜色的对象检测与跟踪">视频分析与对象跟踪-背景消去建模和基于颜色的对象检测与跟踪</a></li><li><a href="/2019/07/04/computer-vision/text38/" rel="bookmark" title="视频分析与对象跟踪-基于光流算法">视频分析与对象跟踪-基于光流算法</a></li><li><a href="/2019/07/07/computer-vision/text39/" rel="bookmark" title="视频分析与对象跟踪-CamShift 算法">视频分析与对象跟踪-CamShift 算法</a></li><li><a href="/2019/07/11/computer-vision/text40/" rel="bookmark" title="视频分析与对象跟踪-OpenCV 扩展模块的单目标、多目标跟踪">视频分析与对象跟踪-OpenCV 扩展模块的单目标、多目标跟踪</a></li><li><a href="/2019/07/15/computer-vision/text41/" rel="bookmark" title="级联分类器训练与使用实战-Haar 与 LBP 级联分类器的使用">级联分类器训练与使用实战-Haar 与 LBP 级联分类器的使用</a></li><li><a href="/2019/07/17/computer-vision/text42/" rel="bookmark" title="级联分类器训练与使用实战-眼睛检测和猫脸检测">级联分类器训练与使用实战-眼睛检测和猫脸检测</a></li><li><a href="/2019/07/21/computer-vision/text43/" rel="bookmark" title="级联分类器训练与使用实战-Adaboost 级联分类器">级联分类器训练与使用实战-Adaboost 级联分类器</a></li><li><a href="/2019/07/23/computer-vision/text44/" rel="bookmark" title="级联分类器训练与使用实战-训练自己的物体分类器">级联分类器训练与使用实战-训练自己的物体分类器</a></li><li><a href="/2019/07/25/computer-vision/text45/" rel="bookmark" title="OpenCV 深度神经网络（DNN）模块 - 使用 goolenet 模型实现图像分类">OpenCV 深度神经网络（DNN）模块 - 使用 goolenet 模型实现图像分类</a></li><li><a href="/2019/07/27/computer-vision/text46/" rel="bookmark" title="OpenCV 深度神经网络（DNN）模块 -Mobilenet_SSD深度学习模型的调用与目标识别">OpenCV 深度神经网络（DNN）模块 -Mobilenet_SSD深度学习模型的调用与目标识别</a></li><li class="active"><a href="/2019/07/28/computer-vision/text47/" rel="bookmark" title="OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割">OpenCV 深度神经网络（DNN）模块 - FCN实现图像切割</a></li><li><a href="/2019/07/29/computer-vision/text48/" rel="bookmark" title="OpenCV 深度神经网络（DNN）模块 - 基于CNN的年龄性别检测">OpenCV 深度神经网络（DNN）模块 - 基于CNN的年龄性别检测</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Mr.Wang" data-src="/images/author.jpg"><p class="name" itemprop="name">Mr.Wang</p><div class="description" itemprop="description">一只行走的红烧肉</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">60</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">11</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLzEyNDE3MTY2MTY=" title="https:&#x2F;&#x2F;github.com&#x2F;1241716616"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTIxNDE1NzI1MjA=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;2141572520"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjEyNDE3MTY2MTZAcXEuY29t" title="mailto:1241716616@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2019/07/27/computer-vision/text46/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2019/07/29/computer-vision/text48/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/" title="分类于 C++基础知识">C++基础知识</a></div><span><a href="/2018/09/30/computer-science/text11/" title="基于多态的企业职工系统">基于多态的企业职工系统</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/" title="分类于 C++基础知识">C++基础知识</a></div><span><a href="/2018/09/29/computer-science/text10/" title="STL-容器-案例">STL-容器-案例</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/09/06/computer-science/text54/" title="爬取猫眼电影Top100数据">爬取猫眼电影Top100数据</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/09/10/computer-science/text57/" title="爬取昆明公交路线">爬取昆明公交路线</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/" title="分类于 C++基础知识">C++基础知识</a></div><span><a href="/2018/09/26/computer-science/text8/" title="模板">模板</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/08/28/computer-science/text50/" title="数据解析">数据解析</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/08/26/computer-science/text49/" title="网络请求">网络请求</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/" title="分类于 C++基础知识">C++基础知识</a></div><span><a href="/2018/09/14/computer-science/text1/" title="C++基础">C++基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/09/01/computer-science/text51/" title="数据解析 - 正则表达式和 re 模块常用函数">数据解析 - 正则表达式和 re 模块常用函数</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Webspider/" title="分类于 网页爬虫">网页爬虫</a></div><span><a href="/2019/09/03/computer-science/text52/" title="豆瓣网电影数据爬取">豆瓣网电影数据爬取</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Mr.Wang @ 业余天王</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">389k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">5:53</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2019/07/28/computer-vision/text47/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>